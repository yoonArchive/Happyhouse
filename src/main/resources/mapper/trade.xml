<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.ssafy.happyhouse.model.mapper.TradeMapper">
    <select id="getSiList" resultType="string">
        select distinct sidoName
        from baseaddress
    </select>

    <select id="getGuList" parameterType="string" resultType="string">
        select distinct gugunName
        from baseaddress
        where sidoName = #{si}
    </select>

    <select id="getDongList" parameterType="map" resultType="string">
        select distinct dongName
        from baseaddress
        where sidoName = #{si}
          and gugunName = #{gu}
    </select>

    <select id="searchByDong" parameterType="map" resultType="houseListRequest">
        select hi.aptCode, hi.apartmentName, hi.lat, hi.lng, ba.lat dongLat, ba.lng dongLng
        from houseinfo hi
                 join baseaddress ba
                      on hi.dongcode = ba.dongcode
        where hi.dongCode in
              (select dongCode from baseaddress where sidoName = #{si} and gugunName = #{gu} and dongName = #{dong})
    </select>

    <select id="searchByApt" parameterType="string" resultType="houseListRequest">
        select aptCode, apartmentName, lat, lng
        from houseinfo
        where apartmentName like concat('%', #{apartmentName}, '%')
    </select>
</mapper>